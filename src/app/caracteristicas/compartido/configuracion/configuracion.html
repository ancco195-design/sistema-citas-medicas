<app-navbar></app-navbar>

<div class="contenedor-configuracion">
  <div class="contenido">
    
    <!-- Encabezado -->
    <div class="encabezado">
      <h1>âš™ï¸ ConfiguraciÃ³n</h1>
      <p>Administra la configuraciÃ³n de tu cuenta</p>
    </div>

    <!-- Secciones -->
    <div class="secciones">

      <!-- 1. CAMBIAR CONTRASEÃ‘A -->
      <div class="seccion">
        <div class="seccion-header">
          <div class="seccion-titulo">
            <span class="seccion-icono">ğŸ”’</span>
            <div>
              <h2>Cambiar ContraseÃ±a</h2>
              <p>Actualiza tu contraseÃ±a de acceso</p>
            </div>
          </div>
        </div>

        <div class="seccion-contenido">
          
          <!-- Mensajes -->
          <div *ngIf="mensajeExitoPassword" class="alerta alerta-exito">
            âœ… {{ mensajeExitoPassword }}
          </div>
          
          <div *ngIf="mensajeErrorPassword" class="alerta alerta-error">
            âš ï¸ {{ mensajeErrorPassword }}
          </div>

          <form [formGroup]="formularioPassword" (ngSubmit)="cambiarPassword()">
            
            <div class="grupo-formulario">
              <label for="passwordActual">ContraseÃ±a Actual *</label>
              <div class="input-password">
                <input 
                  [type]="mostrarPasswordActual ? 'text' : 'password'"
                  id="passwordActual"
                  formControlName="passwordActual"
                  placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                  [class.error]="formularioPassword.get('passwordActual')?.invalid && formularioPassword.get('passwordActual')?.touched"
                >
                <button 
                  type="button" 
                  class="btn-toggle-password"
                  (click)="togglePasswordActual()"
                >
                  {{ mostrarPasswordActual ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸' }}
                </button>
              </div>
              <span class="mensaje-error" *ngIf="formularioPassword.get('passwordActual')?.invalid && formularioPassword.get('passwordActual')?.touched">
                {{ obtenerMensajeErrorPassword('passwordActual') }}
              </span>
            </div>

            <div class="grupo-formulario">
              <label for="passwordNueva">Nueva ContraseÃ±a *</label>
              <div class="input-password">
                <input 
                  [type]="mostrarPasswordNueva ? 'text' : 'password'"
                  id="passwordNueva"
                  formControlName="passwordNueva"
                  placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                  [class.error]="formularioPassword.get('passwordNueva')?.invalid && formularioPassword.get('passwordNueva')?.touched"
                >
                <button 
                  type="button" 
                  class="btn-toggle-password"
                  (click)="togglePasswordNueva()"
                >
                  {{ mostrarPasswordNueva ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸' }}
                </button>
              </div>
              <span class="mensaje-error" *ngIf="formularioPassword.get('passwordNueva')?.invalid && formularioPassword.get('passwordNueva')?.touched">
                {{ obtenerMensajeErrorPassword('passwordNueva') }}
              </span>
            </div>

            <div class="grupo-formulario">
              <label for="passwordConfirmar">Confirmar Nueva ContraseÃ±a *</label>
              <div class="input-password">
                <input 
                  [type]="mostrarPasswordConfirmar ? 'text' : 'password'"
                  id="passwordConfirmar"
                  formControlName="passwordConfirmar"
                  placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                  [class.error]="(!passwordsCoinciden() && formularioPassword.get('passwordConfirmar')?.touched)"
                >
                <button 
                  type="button" 
                  class="btn-toggle-password"
                  (click)="togglePasswordConfirmar()"
                >
                  {{ mostrarPasswordConfirmar ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸' }}
                </button>
              </div>
              <span class="mensaje-error" *ngIf="!passwordsCoinciden() && formularioPassword.get('passwordConfirmar')?.touched">
                Las contraseÃ±as no coinciden
              </span>
            </div>

            <button 
              type="submit" 
              class="btn-primary"
              [disabled]="cambiandoPassword || formularioPassword.invalid"
            >
              <span *ngIf="!cambiandoPassword">ğŸ”’ Cambiar ContraseÃ±a</span>
              <span *ngIf="cambiandoPassword">Cambiando...</span>
            </button>

          </form>
        </div>
      </div>

      <!-- 2. ELIMINAR CUENTA -->
      <div class="seccion seccion-peligro">
        <div class="seccion-header">
          <div class="seccion-titulo">
            <span class="seccion-icono">ğŸ—‘ï¸</span>
            <div>
              <h2>Eliminar Cuenta</h2>
              <p>Desactiva permanentemente tu cuenta</p>
            </div>
          </div>
        </div>

        <div class="seccion-contenido">
          <p class="texto-advertencia">
            âš ï¸ Al eliminar tu cuenta, se desactivarÃ¡ permanentemente y no podrÃ¡s acceder al sistema. Esta acciÃ³n no se puede deshacer.
          </p>
          
          <button class="btn-peligro" (click)="abrirModalEliminar()">
            ğŸ—‘ï¸ Desactivar mi Cuenta
          </button>
        </div>
      </div>

      <!-- 3. PREGUNTAS FRECUENTES Y AYUDA -->
      <div class="seccion">
        <div class="seccion-header">
          <div class="seccion-titulo">
            <span class="seccion-icono">â“</span>
            <div>
              <h2>Preguntas Frecuentes y Ayuda</h2>
              <p>Encuentra respuestas a las dudas mÃ¡s comunes</p>
            </div>
          </div>
          <button class="btn-expandir" (click)="toggleAyuda()">
            {{ mostrarAyuda ? 'â–²' : 'â–¼' }}
          </button>
        </div>

        <div class="seccion-contenido" *ngIf="mostrarAyuda">
          <div class="faq-lista">
            
            <div class="faq-item">
              <h3>Â¿CÃ³mo agendar una cita?</h3>
              <p>Ve a "Buscar Doctores", selecciona un doctor, elige fecha y hora disponible, y confirma tu cita.</p>
            </div>

            <div class="faq-item">
              <h3>Â¿CÃ³mo cancelar una cita?</h3>
              <p>En "Mis Citas", selecciona la cita que deseas cancelar y haz clic en el botÃ³n "Cancelar".</p>
            </div>

            <div class="faq-item">
              <h3>Â¿Puedo cambiar mis datos personales?</h3>
              <p>SÃ­, ve a "Mi Perfil" y haz clic en "Editar" para actualizar tu informaciÃ³n.</p>
            </div>

            <div class="faq-item">
              <h3>Â¿OlvidÃ© mi contraseÃ±a, quÃ© hago?</h3>
              <p>En la pantalla de inicio de sesiÃ³n, haz clic en "Â¿Olvidaste tu contraseÃ±a?" para recuperarla.</p>
            </div>

            <div class="faq-item">
              <h3>Â¿Necesitas mÃ¡s ayuda?</h3>
              <p>ContÃ¡ctanos al correo: soporte@citasmedicas.com o llama al: 123-456-789</p>
            </div>

          </div>
        </div>
      </div>

    </div>

  </div>
</div>

<!-- Modal Confirmar Eliminar -->
<div class="modal-overlay" *ngIf="mostrarModalEliminar" (click)="cerrarModalEliminar()">
  <div class="modal-contenido" (click)="$event.stopPropagation()">
    <h2>âš ï¸ Â¿EstÃ¡s seguro?</h2>
    <p>Esta acciÃ³n desactivarÃ¡ tu cuenta permanentemente. No podrÃ¡s recuperar tu acceso.</p>
    
    <div class="modal-botones">
      <button class="btn-cancelar" (click)="cerrarModalEliminar()" [disabled]="eliminandoCuenta">
        Cancelar
      </button>
      <button class="btn-confirmar-peligro" (click)="confirmarEliminarCuenta()" [disabled]="eliminandoCuenta">
        <span *ngIf="!eliminandoCuenta">SÃ­, Eliminar Cuenta</span>
        <span *ngIf="eliminandoCuenta">Eliminando...</span>
      </button>
    </div>
  </div>
</div>