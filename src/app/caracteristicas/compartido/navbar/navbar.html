<nav class="navbar">
  <div class="navbar-contenedor">
    
    <!-- Logo y T√≠tulo -->
    <div class="navbar-marca" (click)="irAlInicio()">
      <span class="navbar-icono"><img src="icono.ico" alt=""></span>
      <span class="navbar-titulo">Sistema de Citas M√©dicas</span>
    </div>

    <!-- Men√∫ Desktop -->
    <div class="navbar-menu" [class.mostrar]="mostrarMenuMovil">
      <a 
        *ngFor="let enlace of enlacesMenu"
        [routerLink]="enlace.ruta"
        routerLinkActive="activo"
        class="navbar-enlace"
        (click)="mostrarMenuMovil = false"
      >
        <span class="enlace-icono">{{ enlace.icono }}</span>
        <span>{{ enlace.texto }}</span>
      </a>
    </div>

    <!-- Usuario y Men√∫ -->
    <div class="navbar-usuario">
      
      <!-- Badge del Rol -->
      <div class="usuario-rol">
        {{ rolBadge }}
      </div>

      <!-- Bot√≥n de Usuario -->
      <div class="usuario-dropdown" [class.mostrar]="mostrarMenuUsuario">
        <button 
          class="usuario-boton"
          (click)="toggleMenuUsuario()"
        >
          <!-- Avatar con foto o iniciales - CORREGIDO -->
          <div class="usuario-avatar" *ngIf="!usuario?.foto || usuario?.foto === ''">
            {{ obtenerIniciales() }}
          </div>
          <img 
            *ngIf="usuario?.foto && usuario?.foto !== ''" 
            [src]="usuario?.foto" 
            alt="Foto de perfil" 
            class="usuario-avatar-foto"
          >
          
          <span class="usuario-nombre">{{ nombreCompleto }}</span>
          <span class="usuario-flecha">‚ñº</span>
        </button>

        <!-- Men√∫ Desplegable -->
        <div class="dropdown-menu" *ngIf="mostrarMenuUsuario">
          <div class="dropdown-header">
            <!-- Avatar con foto o iniciales - CORREGIDO -->
            <div class="dropdown-avatar" *ngIf="!usuario?.foto || usuario?.foto === ''">
              {{ obtenerIniciales() }}
            </div>
            <img 
              *ngIf="usuario?.foto && usuario?.foto !== ''" 
              [src]="usuario?.foto" 
              alt="Foto de perfil" 
              class="dropdown-avatar-foto"
            >
            
            <div class="dropdown-info">
              <p class="dropdown-nombre">{{ nombreCompleto }}</p>
              <p class="dropdown-email">{{ usuario?.email }}</p>
            </div>
          </div>
          
          <div class="dropdown-divider"></div>
          
          <a class="dropdown-item" [routerLink]="'/configuracion'">
            <span>‚öôÔ∏è</span>
            <span>Configuraci√≥n</span>
          </a>
          
          <div class="dropdown-divider"></div>
          
          <button class="dropdown-item cerrar-sesion" (click)="cerrarSesion()">
            <span>üö™</span>
            <span>Cerrar Sesi√≥n</span>
          </button>
        </div>
      </div>

      <!-- Bot√≥n Men√∫ M√≥vil -->
      <button 
        class="menu-movil-toggle"
        (click)="toggleMenuMovil()"
      >
        <span class="hamburguesa">‚ò∞</span>
      </button>

    </div>

  </div>
</nav>

<!-- Overlay para cerrar men√∫s -->
<div 
  class="navbar-overlay"
  *ngIf="mostrarMenuUsuario || mostrarMenuMovil"
  (click)="mostrarMenuUsuario = false; mostrarMenuMovil = false"
></div>