<app-navbar></app-navbar>

<div class="container fade-in">
  
  <button class="btn-volver" (click)="volver()">â† Volver a la Agenda</button>

  <div *ngIf="cargando" class="loading">Cargando detalles...</div>

  <div *ngIf="cita" class="detalle-card">
    
    <!-- HEADER CON COLOR DINÃMICO -->
    <!-- [ngClass] cambia el color de fondo segÃºn si es pendiente/confirmada/etc -->
    <div class="header-cita" [ngClass]="cita.estado">
      <div>
        <h1>Consulta MÃ©dica</h1>
        <span class="fecha">{{ formatearFecha(cita.fecha) | date:'fullDate' | titlecase }} - {{ cita.hora }}</span>
      </div>
      <span class="badge">{{ cita.estado | uppercase }}</span>
    </div>

    <div class="body-cita">
      <!-- DATOS PACIENTE -->
      <div class="seccion">
        <h3>ğŸ‘¤ Paciente</h3>
        <p class="dato-grande">{{ cita.pacienteNombre }}</p>
      </div>

      <!-- MOTIVO -->
      <div class="seccion">
        <h3>ğŸ“‹ Motivo de Consulta</h3>
        <div class="caja-texto">{{ cita.motivo }}</div>
      </div>

      <!-- NOTAS MÃ‰DICAS -->
      <div class="seccion">
        <h3>ğŸ“ Notas del Doctor / DiagnÃ³stico</h3>
        <!-- ngModel conecta con la variable notasMedicas del TS -->
        <textarea 
          [(ngModel)]="notasMedicas" 
          class="form-control area-notas"
          [disabled]="cita.estado === 'cancelada' || cita.estado === 'completada'"
          placeholder="Escriba aquÃ­ el diagnÃ³stico, receta o indicaciones..."></textarea>
      </div>
    </div>

    <!-- BOTONES DE ACCIÃ“N -->
    <div class="footer-actions">
      <!-- BotÃ³n para Confirmar si estÃ¡ pendiente -->
      <button *ngIf="cita.estado === 'pendiente'" (click)="confirmar()" class="btn btn-confirmar">
        Aceptar Cita
      </button>

      <!-- BotÃ³n para Finalizar si estÃ¡ confirmada -->
      <button *ngIf="cita.estado === 'confirmada'" (click)="guardarNotas()" class="btn btn-guardar">
        Guardar Notas / Finalizar
      </button>

      <!-- Mensaje si ya finalizÃ³ -->
      <span *ngIf="cita.estado === 'completada'" class="texto-finalizado">Consulta Finalizada</span>
    </div>

  </div>
</div>