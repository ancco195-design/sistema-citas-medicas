<!-- Navbar -->
<app-navbar></app-navbar>

<!-- Contenedor Principal -->
<div class="contenedor-principal">
  <div class="contenido">

    <!-- Encabezado -->
    <div class="encabezado">
      <div class="encabezado-texto">
        <h1>ğŸ” Buscar Doctores</h1>
        <p>Encuentra al especialista que necesitas</p>
      </div>
    </div>

    <!-- Loader mientras carga -->
    <div *ngIf="cargando" class="sin-resultados">
      <div class="sin-resultados-icono">â³</div>
      <h3>Cargando doctores...</h3>
      <p>Por favor espera un momento</p>
    </div>

    <!-- Contenido cuando ya cargÃ³ -->
    <ng-container *ngIf="!cargando">

      <!-- Filtros -->
      <div class="seccion-filtros">
        <div class="filtros-contenedor">
          
          <!-- BÃºsqueda por nombre -->
          <div class="filtro-grupo">
            <label>ğŸ” Buscar por nombre</label>
            <input 
              type="text"
              [(ngModel)]="filtroBusqueda"
              (ngModelChange)="aplicarFiltros()"
              placeholder="Nombre del doctor..."
              class="filtro-input"
            >
          </div>

          <!-- Filtro por especialidad -->
          <div class="filtro-grupo">
            <label>ğŸ©º Especialidad</label>
            <select 
              [(ngModel)]="filtroEspecialidad"
              (ngModelChange)="aplicarFiltros()"
              class="filtro-select"
            >
              <option value="">Todas las especialidades</option>
              <option *ngFor="let esp of especialidades" [value]="esp.nombre">
                {{ esp.icono }} {{ esp.nombre }}
              </option>
            </select>
          </div>

          <!-- BotÃ³n limpiar -->
          <div class="filtro-grupo">
            <label>&nbsp;</label>
            <button 
              class="btn-limpiar"
              (click)="limpiarFiltros()"
              *ngIf="filtroEspecialidad || filtroBusqueda"
            >
              ğŸ—‘ï¸ Limpiar filtros
            </button>
          </div>

        </div>

        <!-- Resultados -->
        <div class="resultados-contador">
          <p>
            <strong>{{ doctoresFiltrados.length }}</strong> 
            {{ doctoresFiltrados.length === 1 ? 'doctor encontrado' : 'doctores encontrados' }}
          </p>
        </div>
      </div>

      <!-- Lista de Doctores -->
      <div class="lista-doctores">

        <!-- Sin resultados -->
        <div *ngIf="doctoresFiltrados.length === 0" class="sin-resultados">
          <div class="sin-resultados-icono">ğŸ˜”</div>
          <h3>No se encontraron doctores</h3>
          <p>Intenta cambiar los filtros de bÃºsqueda</p>
          <button class="btn-secondary" (click)="limpiarFiltros()">
            Limpiar filtros
          </button>
        </div>

        <!-- Grid de Doctores -->
        <div *ngIf="doctoresFiltrados.length > 0" class="grid-doctores">
          
          <div 
            *ngFor="let doctor of doctoresFiltrados"
            class="tarjeta-doctor"
          >
            
            <!-- Foto del doctor -->
            <div class="doctor-foto">
              <div class="foto-placeholder" *ngIf="!obtenerFotoDoctor(doctor.uid)">
                {{ obtenerIniciales(doctor.uid) }}
              </div>
              <img 
                *ngIf="obtenerFotoDoctor(doctor.uid)"
                [src]="obtenerFotoDoctor(doctor.uid)" 
                [alt]="obtenerNombreDoctor(doctor.uid)"
              >
            </div>

            <!-- InformaciÃ³n del doctor -->
            <div class="doctor-info">
              
              <h3 class="doctor-nombre">{{ obtenerNombreDoctor(doctor.uid) }}</h3>
              
              <div class="doctor-especialidad">
                <span class="especialidad-icono">{{ obtenerIconoEspecialidad(doctor.especialidad) }}</span>
                <span>{{ doctor.especialidad }}</span>
              </div>

              <div class="doctor-detalles">
                <div class="detalle-item">
                  <span class="detalle-icono">ğŸ’¼</span>
                  <span>{{ doctor['aÃ±osExperiencia'] }} aÃ±os de experiencia</span>
                </div>
                
                <div class="detalle-item">
                  <span class="detalle-icono">ğŸ¥</span>
                  <span>{{ doctor.consultorio }}</span>
                </div>

                <div class="detalle-item" *ngIf="doctor.calificacion">
                  <span class="detalle-icono">{{ obtenerEstrellas(doctor.calificacion) }}</span>
                  <span>({{ doctor.calificacion }}/5)</span>
                </div>
              </div>

              <!-- BiografÃ­a (truncada) -->
              <p class="doctor-bio">
                {{ doctor.biografia.length > 100 ? (doctor.biografia.substring(0, 100) + '...') : doctor.biografia }}
              </p>

            </div>

            <!-- Acciones -->
            <div class="doctor-acciones">
              <button 
                class="btn-detalle"
                (click)="verDetalle(doctor)"
              >
                ğŸ‘ï¸ Ver Perfil
              </button>
              
              <button 
                class="btn-agendar"
                (click)="agendarCita(doctor)"
              >
                ğŸ“… Agendar Cita
              </button>
            </div>

          </div>

        </div>

      </div>

    </ng-container>

  </div>
</div>