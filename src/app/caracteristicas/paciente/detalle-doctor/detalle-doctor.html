<app-navbar></app-navbar>

<div class="contenedor-detalle">
  
  <!-- Bot√≥n Volver -->
  <button class="btn-volver" (click)="volver()">
    ‚Üê Volver a Doctores
  </button>

  <!-- Loader -->
  <div *ngIf="cargando" class="cargando">
    <div class="spinner"></div>
    <p>Cargando informaci√≥n del doctor...</p>
  </div>

  <!-- Error -->
  <div *ngIf="!cargando && errorCarga" class="mensaje-error">
    <div class="error-icono">‚ùå</div>
    <h2>Doctor no encontrado</h2>
    <p>No se pudo cargar la informaci√≥n del doctor</p>
    <button class="btn-primary" (click)="volver()">Volver a la lista</button>
  </div>

  <!-- Detalle del Doctor -->
  <div *ngIf="!cargando && !errorCarga && doctor && usuario" class="detalle-contenido">
    
    <!-- Tarjeta Principal -->
    <div class="tarjeta-principal">
      
      <!-- Header con foto y datos b√°sicos -->
      <div class="header-doctor">
        <div class="foto-container">
          <div *ngIf="!doctor.foto" class="foto-placeholder">
            {{ obtenerIniciales() }}
          </div>
          <img 
            *ngIf="doctor.foto"
            [src]="doctor.foto" 
            [alt]="nombreCompleto"
            class="foto-doctor"
            (error)="onImageError($event)"
          >
        </div>
        
        <div class="info-basica">
          <h1>{{ nombreCompleto }}</h1>
          <p class="especialidad">
            ü©∫ {{ doctor.especialidad }}
          </p>
          
          <!-- Calificaci√≥n -->
          <div class="calificacion" *ngIf="doctor.calificacion">
            <span 
              *ngFor="let estrella of estrellas" 
              [class.llena]="estrella === 1"
              class="estrella"
            >
              {{ estrella === 1 ? '‚≠ê' : '‚òÜ' }}
            </span>
            <span class="numero-calificacion">{{ doctor.calificacion }}/5</span>
          </div>

          <!-- Experiencia -->
          <div class="experiencia">
            <span class="icono">üìÖ</span>
            <span>{{ aniosExperiencia }} a√±os de experiencia</span>
          </div>
        </div>
      </div>

      <!-- Datos de contacto -->
      <div class="seccion-info">
        <h3>üìû Informaci√≥n de Contacto</h3>
        <div class="info-grid">
          <div class="info-item">
            <span class="label">Email:</span>
            <span class="valor">{{ usuario.email }}</span>
          </div>
          <div class="info-item">
            <span class="label">Tel√©fono:</span>
            <!-- ‚ú® PIPE APLICADO AQU√ç -->
            <span class="valor">{{ usuario.telefono | telefono }}</span>
          </div>
          <div class="info-item">
            <span class="label">Consultorio:</span>
            <span class="valor">{{ doctor.consultorio }}</span>
          </div>
          <div class="info-item" *ngIf="doctor.numeroCitas">
            <span class="label">Consultas realizadas:</span>
            <span class="valor">{{ doctor.numeroCitas }}</span>
          </div>
        </div>
      </div>

      <!-- Biograf√≠a -->
      <div class="seccion-info">
        <h3>üë®‚Äç‚öïÔ∏è Sobre el Doctor</h3>
        <p class="biografia">{{ doctor.biografia }}</p>
      </div>

      <!-- Horarios de Atenci√≥n -->
      <div class="seccion-info">
        <h3>üïê Horarios de Atenci√≥n</h3>
        
        <div *ngIf="obtenerDiasActivos().length === 0" class="sin-horarios">
          <p>No hay horarios disponibles en este momento</p>
        </div>

        <div *ngIf="obtenerDiasActivos().length > 0" class="horarios-lista">
          <div 
            *ngFor="let dia of ['Lunes', 'Martes', 'Mi√©rcoles', 'Jueves', 'Viernes', 'S√°bado', 'Domingo']" 
            class="horario-item"
            [class.activo]="obtenerDiasActivos().includes(dia)"
          >
            <span class="dia">{{ dia }}</span>
            <span class="horas">{{ obtenerHorarioDia(dia) }}</span>
          </div>
        </div>
      </div>

      <!-- Bot√≥n de Acci√≥n -->
      <div class="acciones">
        <button class="btn-agendar" (click)="agendarCita()">
          üìÖ Agendar Cita con este Doctor
        </button>
      </div>

    </div>

  </div>

</div>